!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/scripts",n(n.s=14)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var r=function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.constructor===e)throw new TypeError("Cannot construct Abstract instances directly");this.color="black"}return o(e,[{key:"action",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2];throw new TypeError("Do not call abstract method foo from child.")}},{key:"sendToSocket",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];throw new TypeError("Do not call abstract method foo from child.")}}]),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));var i=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(e.constructor===t)throw new TypeError("Cannot construct Abstract instances directly");return e.selectedSize=5,e.style="round",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),o(t,[{key:"changeSize",value:function(e){t.isInvalidSize(e)||(this.selectedSize=e)}},{key:"action",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];o&&e.savePreviousDrawing(),e.selectTool(this),t.draw(e,o),n.push({x:e.currentX,y:e.currentY})}},{key:"sendToSocket",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t.length>0){e.saveCurrentDrawing();var n=e.selectedTool,o=e.selectedColor,r=e.currentDrawing,i=e.previousDrawing,a=e.socket;a.sendFreeHandDrawing(t,n,o),a.sendDrawData({current:r,previous:i})}}},{key:"sendToSocketPartial",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t.length>0){var n=e.selectedTool,o=e.selectedColor;e.socket.sendFreeHandDrawing(t,n,o)}}}],[{key:"isInvalidSize",value:function(e){return e<5||e>25}},{key:"draw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.context,o=e.previousX,r=e.previousY,i=e.currentX,a=e.currentY;n.beginPath(),t||n.moveTo(o,r),n.lineTo(i,a),n.stroke()}}]),t}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hexToRGBA=function(e){var t=void 0;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e))return 3===(t=e.substring(1).split("")).length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]]),{r:(t="0x"+t.join(""))>>16&255,g:t>>8&255,b:255&t,a:255};throw new Error("Bad Hex")},t.rgbToHex=function(e,t,n){return"#"+((1<<24)+(e<<16)+(t<<8)+n).toString(16).slice(1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){return e&&e.__esModule?e:{default:e}}(n(1));var r=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.compositeOperation="source-over",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),t}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvasController=t}return o(e,[{key:"setEvents",value:function(){var e=this;document.addEventListener("mousedown",function(t){return e.sizeMenuHandler(t)}),document.addEventListener("touchstart",function(t){return e.sizeMenuHandler(t)})}},{key:"sizeMenuHandler",value:function(e){var t=document.getElementById("size-menu");if(null!==t)if(null===e.target.closest("#size-menu"))t.remove();else if(null!==e.target.closest(".tools-menu__size-container")){var n=e.target.closest(".tools-menu__size-container"),o=n.dataset.size;this.canvasController.changeToolSize(o),n.firstElementChild.classList.add("tools-menu__size--active")}}}]),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(n(3));var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.socket=io(),this.notificar=!0,this.ultimaNotifacao=new Date}return o(e,[{key:"init",value:function(t){var n=this;this.socket.on("draw",function(e){e.id!==n.socket.id&&(e.path.length<1||t.drawFromSocket(e))}),this.socket.on("flood",function(e){e.id!==n.socket.id&&t.floodFillFromSocket(e)}),this.socket.on("getCurrentDrawing",function(n){e.setImage(n,t)}),this.socket.on("undo",function(n){e.setImage(n,t)}),this.socket.on("redo",function(n){e.setImage(n,t)}),this.socket.on("clear",function(){t.setImage(null,!0)})}},{key:"sendFreeHandDrawing",value:function(e,t,n){var o=Object.assign(t,{selectedColor:n}),i=o instanceof r.default;this.socket.emit("draw",{path:e,brush:o,id:this.socket.id,notify:this.notificar,isBrush:i})}},{key:"sendFloodFill",value:function(e,t){var n=[e[0],e[1]];this.socket.emit("flood",{position:n,selectedColor:t,id:this.socket.id})}},{key:"sendDrawData",value:function(e){this.socket.emit("newDrawData",e)}},{key:"sendUndo",value:function(){this.socket.emit("undo")}},{key:"sendRedo",value:function(){this.socket.emit("redo")}},{key:"sendClear",value:function(){this.socket.emit("clear")}}],[{key:"setImage",value:function(e,t){var n=e.image;null!==n&&t.setImage(n)}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),i=n(2);var a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),o(t,[{key:"action",value:function(e){e.stopDrawing();var t=e.context,n=e.currentX,o=e.currentY,r=e.iconEvents,a=(e.selectedColor,e.selectedColorRGBA),c=t.getImageData(n,o,1,1).data,s={r:c[0],g:c[1],b:c[2],a:c[3]};a=s;var u=a.r,l=a.g,f=a.b;r.colorPicker.value=(0,i.rgbToHex)(u,l,f),r.colorPicker.dispatchEvent(new Event("change",{bubbles:!0})),r.brushIcon.click()}}]),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,r){t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]);var i={r:n[0],g:n[1],b:n[2],a:n[3]};if(i.r==o.r&&i.g==o.g&&i.b==o.b&&i.a==o.a)return;var a=e.getImageData(0,0,r.width,r.height),c=a.data,s=void 0,u=[];function l(e,t){var n={r:c[e],g:c[e+1],b:c[e+2],a:c[e+3]};if(n.r==o.r&&n.g==o.g&&n.b==o.b&&n.a==o.a)return!1;var r=Math.sqrt(o.r*o.r*.299+o.g*o.g*.587+o.b*o.b*.114);return s=r>200?20:r>85?175:250,Math.abs(n.r-t.r)<=s&&Math.abs(n.g-t.g)<=s&&Math.abs(n.b-t.b)<=s&&Math.abs(n.a-t.a)<=s}function f(e){c[e]=o.r,c[e+1]=o.g,c[e+2]=o.b,c[e+3]=o.a}u.push([t[0],t[1]]);for(;u.length&&!(u.length>100);){var h=void 0,d=void 0,v=void 0,p=void 0,y=void 0,g=void 0;for(h=u.pop(),d=h[0],v=h[1],p=4*(v*r.width+d);v>=0&&l(p,i);)p-=4*r.width,v--;for(p+=4*r.width,v++,y=!1,g=!1;v<r.height&&l(p,i);)f(p),d>0&&(l(p-4,i)?y||(u.push([d-1,v]),y=!0):y&&(y=!1)),d<r.width-1&&(l(p+4,i)?g||(u.push([d+1,v]),g=!0):g&&(g=!1)),p+=4*r.width,v++}e.putImageData(a,0,0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=a(n(0)),i=a(n(7));function a(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.compositeOperation="source-over",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),o(t,[{key:"action",value:function(e){var t=e.canvas,n=e.context,o=e.currentX,r=e.currentY,a=e.selectedColorRGBA;e.startDrawing(),e.savePreviousDrawing(),this.selectedColor=a,this.position=[o,r],this.clickedPixel=n.getImageData(o,r,1,1).data,(0,i.default)(n,this.position,this.clickedPixel,a,t),e.saveCurrentDrawing()}},{key:"sendToSocket",value:function(e){e.saveCurrentDrawing();var t=e.currentDrawing,n=e.previousDrawing,o=e.socket;o.sendFloodFill(this.position,this.selectedColor),o.sendDrawData({current:t,previous:n})}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){return e&&e.__esModule?e:{default:e}}(n(1));var r=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.compositeOperation="destination-out",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),t}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(2),i=function(e){return e&&e.__esModule?e:{default:e}}(n(1));var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvasController=t,this.burguerIcon=document.getElementById("burguer-icon"),this.brushIcon=document.getElementById("brush-icon"),this.eraserIcon=document.getElementById("eraser-icon"),this.bucketIcon=document.getElementById("bucket-icon"),this.pickerIcon=document.getElementById("picker-icon"),this.textIcon=document.getElementById("text-icon"),this.colorIcon=document.getElementById("color-icon"),this.clearIcon=document.getElementById("clear-icon"),this.btnUndo=document.getElementById("btn-undo"),this.btnRedo=document.getElementById("btn-redo"),this.colorPicker=document.createElement("input"),this.colorPicker.setAttribute("type","color")}return o(e,[{key:"setEvents",value:function(){var e=this;this.burguerIcon.addEventListener("click",function(){}),this.brushIcon.addEventListener("click",function(t){e.selectTool(t,e.brushIcon,e.canvasController.tools.brush)}),this.eraserIcon.addEventListener("click",function(t){e.selectTool(t,e.eraserIcon,e.canvasController.tools.eraser)}),this.bucketIcon.addEventListener("click",function(t){e.selectTool(t,e.bucketIcon,e.canvasController.tools.bucket)}),this.pickerIcon.addEventListener("click",function(t){e.selectTool(t,e.pickerIcon,e.canvasController.tools.picker)}),this.colorIcon.addEventListener("click",function(){e.colorPicker.click()}),this.colorPicker.addEventListener("change",function(){e.changeColor()}),this.clearIcon.addEventListener("click",function(){e.clearCanvas()}),this.btnUndo.addEventListener("mousedown",function(t){e.undo(t)}),this.btnRedo.addEventListener("mousedown",function(t){e.redo(t)})}},{key:"selectTool",value:function(t,n,o){t.preventDefault(),t.stopPropagation(),e.closeOpenedSizeMenu(),e.removeActiveClass(),n.firstElementChild.classList.add("tools-menu__icon--active"),o instanceof i.default&&e.openSizeMenu(n,o),this.canvasController.selectTool(o)}},{key:"clearCanvas",value:function(){this.canvasController.clearCanvas()}},{key:"changeColor",value:function(){var e=(0,r.hexToRGBA)(this.colorPicker.value),t="RGBA("+e.r+","+e.g+","+e.b+","+e.a+")";this.canvasController.selectedColorRGBA=e,this.canvasController.selectedColor=t,this.canvasController.changeColor(),document.documentElement.style.setProperty("--selected-color",t)}},{key:"undo",value:function(e){e.preventDefault(),e.stopPropagation(),this.canvasController.socket.sendUndo()}},{key:"redo",value:function(e){e.preventDefault(),e.stopPropagation(),this.canvasController.socket.sendRedo()}}],[{key:"openSizeMenu",value:function(t,n){t.childElementCount>1||e.createSizeMenuElement(t,n)}},{key:"createSizeMenuElement",value:function(e,t){var n=document.createElement("div");n.id="size-menu",n.classList.add("tools-menu__size-selector"),n.innerHTML=[5,10,15,20,25].map(function(e,t){return'\n    <div class="tools-menu__size-container" data-size="'+e+'">\n        <div class="tools-menu__size--'+(t+1)+'"></div>\n    </div>\n    '}).join(""),e.appendChild(n),document.querySelector("[data-size='"+t.selectedSize+"']").firstElementChild.classList.add("tools-menu__size--active")}},{key:"closeOpenedSizeMenu",value:function(){var e=document.getElementById("size-menu");null!==e&&e.remove()}},{key:"removeActiveClass",value:function(){document.querySelectorAll(".tools-menu__icon").forEach(function(e){e.classList.remove("tools-menu__icon--active")})}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,r){t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]);var i={r:n[0],g:n[1],b:n[2],a:n[3]};if(i.r==o.r&&i.g==o.g&&i.b==o.b&&i.a==o.a)return;var a=e.getImageData(0,0,r.width,r.height),c=a.data,s=void 0,u=[];function l(e,t){var n={r:c[e],g:c[e+1],b:c[e+2],a:c[e+3]};if(n.r==o.r&&n.g==o.g&&n.b==o.b&&n.a==o.a)return!1;var r=Math.sqrt(o.r*o.r*.299+o.g*o.g*.587+o.b*o.b*.114);return s=r>200?20:r>85?175:250,Math.abs(n.r-t.r)<=s&&Math.abs(n.g-t.g)<=s&&Math.abs(n.b-t.b)<=s&&Math.abs(n.a-t.a)<=s}function f(e){c[e]=o.r,c[e+1]=o.g,c[e+2]=o.b,c[e+3]=o.a}u.push([t[0],t[1]]);for(;u.length&&!(u.length>100);){var h=void 0,d=void 0,v=void 0,p=void 0,y=void 0,g=void 0;for(h=u.pop(),d=h[0],v=h[1],p=4*(v*r.width+d);v>=0&&l(p,i);)p-=4*r.width,v--;for(p+=4*r.width,v++,y=!1,g=!1;v<r.height&&l(p,i);)f(p),d>0&&(l(p-4,i)?y||(u.push([d-1,v]),y=!0):y&&(y=!1)),d<r.width-1&&(l(p+4,i)?g||(u.push([d+1,v]),g=!0):g&&(g=!1)),p+=4*r.width,v++}e.putImageData(a,0,0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pathArray=[]}return o(e,[{key:"stopDrawing",value:function(t,n){t.preventDefault(),n.drawing&&(e.isDrawingOverUndoRedo(t)||(n.stopDrawing(),n.selectedTool.sendToSocket(n,this.pathArray),this.pathArray=[]))}},{key:"clickStartHandler",value:function(e,t){e.preventDefault(),"mousedown"===e.type&&(e.buttons>1||(t.setPositions(e.clientX,e.clientY),this.handleClickTouch(t)))}},{key:"touchStartHandler",value:function(e,t){e.preventDefault();var n=e.changedTouches;if(!(n.length>1)){var o=n[0];t.setPositions(o.clientX,o.clientY),this.handleClickTouch(t)}}},{key:"handleClickTouch",value:function(e){e.startDrawing(),e.selectedTool.action(e,this.pathArray,!0)}},{key:"mouseMoveHandler",value:function(t,n){if(t.preventDefault(),!e.isPickerOrBucket(n)){var o={x:t.clientX,y:t.clientY};this.handleClickTouchMove(n,o)}}},{key:"toucheMoveHandler",value:function(t,n){if(t.preventDefault(),!e.isPickerOrBucket(n)){var o=t.changedTouches;if(!(o.length>1)){var r=o[0],i={x:r.clientX,y:r.clientY};this.handleClickTouchMove(n,i)}}}},{key:"handleClickTouchMove",value:function(e,t){e.drawing&&(e.setPositions(t.x,t.y),e.selectedTool.action(e,this.pathArray),50===this.pathArray.length&&(e.selectedTool.sendToSocketPartial(e,this.pathArray),this.pathArray=this.pathArray.slice(49)))}}],[{key:"isPickerOrBucket",value:function(e){return"picker"===e.selectedTool||"bucket"===e.selectedTool}},{key:"isDrawingOverUndoRedo",value:function(e){return"mouseout"===e.type&&e.target.closest("#canvas-holder")}}]),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=h(n(12)),i=h(n(11)),a=h(n(10)),c=n(2),s=h(n(3)),u=h(n(9)),l=h(n(8)),f=h(n(6));function h(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tools={brush:new s.default,eraser:new u.default,bucket:new l.default,picker:new f.default},this.canvas=document.getElementById("canvas"),this.context=this.canvas.getContext("2d"),this.canvasContainer=this.canvas.parentElement,this.selectedTool=this.tools.brush,this.selectedColor="black",this.selectedColorRGBA={r:0,g:0,b:0,a:255},this.drawing=!1,this.resizeCanvas(),this.setEvents(),this.currentX=null,this.currentY=null,this.previousX=null,this.previousY=null,this.previousDrawing=null,this.currentDrawing=null,this.events=new r.default,this.iconEvents=new a.default(this),this.iconEvents.setEvents(),this.socket=t}return o(e,[{key:"setCanvasStyle",value:function(e,t){this.canvas.style.width=e+"px",this.canvas.style.height=t+"px"}},{key:"resizeCanvas",value:function(){this.width=this.canvasContainer.clientWidth,this.height=Math.floor(this.width/16*9),this.setCanvasStyle(this.width,this.height),this.canvasContainer.style.height=this.height+"px"}},{key:"selectTool",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&(this.selectedTool=e,this.selectedTool.selectedColor=this.selectedColor),this.setContextStyle(this.selectedTool)}},{key:"selectToolSocket",value:function(e){this.setContextStyle(e)}},{key:"setContextStyle",value:function(e){this.context.globalCompositeOperation=e.compositeOperation,this.context.strokeStyle=e.selectedColor||this.selectedColor,this.context.lineWidth=e.selectedSize,this.context.lineCap=e.style,this.context.lineJoin=e.style}},{key:"changeToolSize",value:function(e){this.selectedTool.changeSize(e)}},{key:"changeColor",value:function(){this.context.strokeStyle=this.selectedColor}},{key:"setPositions",value:function(e,t){this.previousX=this.currentX,this.previousY=this.currentY;var n=this.canvas.getBoundingClientRect(),o=this.canvas.width/n.width,r=this.canvas.height/n.height;this.currentX=(e-n.left)*o,this.currentY=(t-n.top)*r}},{key:"drawFromSocket",value:function(e){var t=e.isBrush?new s.default:new u.default,n=Object.assign(t,e.brush);if(this.context.beginPath(),this.context.moveTo(e.path[0].x,e.path[0].y),this.selectToolSocket(n),1===e.path.length)return this.context.lineTo(e.path[0].x,e.path[0].y),void this.context.stroke();for(var o=1;o<e.path.length;o+=1)this.selectToolSocket(n),this.context.lineTo(e.path[o].x,e.path[o].y);this.context.stroke()}},{key:"floodFillFromSocket",value:function(e){var t=e.position,n=this.context.getImageData(t[0],t[1],1,1).data;(0,i.default)(this.context,t,n,e.selectedColor,this.canvas)}},{key:"getColor",value:function(){var e=this.context.getImageData(this.currentX,this.currentY,1,1).data,t={r:e[0],g:e[1],b:e[2],a:e[3]};this.selectedColorRGBA=t,this.selectedColor="RGBA("+t.r+", "+t.g+", "+t.b+", "+t.a+")";var n=this.selectedColorRGBA,o=n.r,r=n.g,i=n.b;this.iconEvents.colorPicker.value=(0,c.rgbToHex)(o,r,i),this.iconEvents.colorPicker.dispatchEvent(new Event("change",{bubbles:!0})),this.iconEvents.brushIcon.click()}},{key:"savePreviousDrawing",value:function(){this.previousDrawing=this.canvas.toDataURL()}},{key:"saveCurrentDrawing",value:function(){this.currentDrawing=this.canvas.toDataURL()}},{key:"startDrawing",value:function(){this.drawing=!0}},{key:"stopDrawing",value:function(){this.drawing=!1}},{key:"setImage",value:function(e){var t=this;if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])this.context.clearRect(0,0,this.canvas.width,this.canvas.height);else if(null!==e){var n=new Image;n.src=e,n.onload=function(){var e=t.context.globalCompositeOperation;t.context.globalCompositeOperation="source-over",t.context.clearRect(0,0,t.canvas.width,t.canvas.height),t.context.drawImage(n,0,0,t.canvas.width,t.canvas.height),t.context.globalCompositeOperation=e}}}},{key:"clearCanvas",value:function(){this.savePreviousDrawing(),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.saveCurrentDrawing(),this.socket.sendClear(),this.socket.sendDrawData({current:this.currentDrawing,previous:this.previousDrawing})}},{key:"setEvents",value:function(){var e=this;this.canvasContainer.addEventListener("mousedown",function(t){e.events.clickStartHandler(t,e)}),this.canvasContainer.addEventListener("touchstart",function(t){e.events.touchStartHandler(t,e)}),this.canvasContainer.addEventListener("mouseup",function(t){e.events.stopDrawing(t,e)}),this.canvasContainer.addEventListener("mouseout",function(t){e.events.stopDrawing(t,e)}),this.canvasContainer.addEventListener("touchend",function(t){e.events.stopDrawing(t,e)}),this.canvasContainer.addEventListener("touchcancel",function(t){e.events.stopDrawing(t,e)}),this.canvasContainer.addEventListener("mousemove",function(t){e.events.mouseMoveHandler(t,e)}),this.canvasContainer.addEventListener("touchmove",function(t){e.events.toucheMoveHandler(t,e)})}}]),e}();t.default=d},function(e,t,n){"use strict";var o=a(n(13)),r=a(n(5)),i=a(n(4));function a(e){return e&&e.__esModule?e:{default:e}}var c=new r.default,s=new o.default(c),u=new i.default(s);s.selectTool(s.tools.brush),u.setEvents(),c.init(s)}]);