!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/scripts",n(n.s=8)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hexToRGBA=function(e){var t=void 0;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e))return 3===(t=e.substring(1).split("")).length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]]),{r:(t="0x"+t.join(""))>>16&255,g:t>>8&255,b:255&t,a:255};throw new Error("Bad Hex")},t.rgbToHex=function(e,t,n){return"#"+((1<<24)+(e<<16)+(t<<8)+n).toString(16).slice(1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvasController=t}return r(e,[{key:"setEvents",value:function(){var e=this;document.addEventListener("mousedown",function(t){return e.sizeMenuHandler(t)}),document.addEventListener("touchstart",function(t){return e.sizeMenuHandler(t)})}},{key:"sizeMenuHandler",value:function(e){var t=document.getElementById("size-menu");if(null!==t)if(null===e.target.closest("#size-menu"))t.remove();else if(null!==e.target.closest(".tools-menu__size-container")){var n=e.target.closest(".tools-menu__size-container"),r=n.dataset.size;"brush"===this.canvasController.selectedTool?this.canvasController.changeBrushValues({selectedSize:r}):this.canvasController.changeEraserValues({selectedSize:r}),n.firstElementChild.classList.add("tools-menu__size--active")}}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.socket=io(),this.notificar=!0,this.ultimaNotifacao=new Date}return r(e,[{key:"init",value:function(e){var t=this;this.socket.on("draw",function(n){n.id!==t.socket.id&&(n.path.length<1||e.drawFromSocket(n))}),this.socket.on("flood",function(n){n.id!==t.socket.id&&e.floodFillFromSocket(n)})}},{key:"sendDraw",value:function(e,t,n){var r=Object.assign(t,{selectedColor:n});this.socket.emit("draw",{path:e,brush:r,id:this.socket.id,notify:this.notificar})}},{key:"sendFloodFill",value:function(e,t){var n=[e[0],e[1]];this.socket.emit("flood",{position:n,selectedColor:t,id:this.socket.id})}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(0);var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvasController=t,this.burguerIcon=document.getElementById("burguer-icon"),this.brushIcon=document.getElementById("brush-icon"),this.eraserIcon=document.getElementById("eraser-icon"),this.bucketIcon=document.getElementById("bucket-icon"),this.pickerIcon=document.getElementById("picker-icon"),this.textIcon=document.getElementById("text-icon"),this.colorIcon=document.getElementById("color-icon"),this.clearIcon=document.getElementById("clear-icon"),this.colorPicker=document.createElement("input"),this.colorPicker.setAttribute("type","color")}return r(e,[{key:"setEvents",value:function(){var e=this;this.burguerIcon.addEventListener("click",function(e){}),this.brushIcon.addEventListener("click",function(t){e.selectTool(t,e.brushIcon,"brush")}),this.eraserIcon.addEventListener("click",function(t){e.selectTool(t,e.eraserIcon,"eraser")}),this.bucketIcon.addEventListener("click",function(t){e.selectTool(t,e.bucketIcon,"bucket")}),this.pickerIcon.addEventListener("click",function(t){e.selectTool(t,e.pickerIcon,"picker")}),this.colorIcon.addEventListener("click",function(t){e.colorPicker.click()}),this.colorPicker.addEventListener("change",function(t){e.changeColor()})}},{key:"selectTool",value:function(t,n,r){t.preventDefault(),t.stopPropagation(),e.closeOpenedSizeMenu(),e.removeActiveClass(),n.firstElementChild.classList.add("tools-menu__icon--active"),"brush"!==r?"eraser"!==r?"bucket"!==r?"picker"===r&&this.selectPicker():this.selectBucket():this.openSizeMenu(n,"eraser"):this.openSizeMenu(n,"brush")}},{key:"openSizeMenu",value:function(e,t){e.childElementCount>1||("brush"===t?(this.canvasController.selectBrush(),this.canvasController.selectedTool="brush"):(this.canvasController.selectEraser(),this.canvasController.selectedTool="eraser"),this.createSizeMenuElement(e,t))}},{key:"selectBucket",value:function(){this.canvasController.selectedTool="bucket"}},{key:"selectPicker",value:function(){this.canvasController.selectedTool="picker"}},{key:"createSizeMenuElement",value:function(e,t){var n=document.createElement("div");n.id="size-menu",n.classList.add("tools-menu__size-selector"),n.innerHTML=[5,10,15,20,25].map(function(e,t){return'\n    <div class="tools-menu__size-container" data-size="'+e+'">\n        <div class="tools-menu__size--'+(t+1)+'"></div>\n    </div>\n    '}).join(""),e.appendChild(n),document.querySelector("[data-size='"+this.canvasController[t].selectedSize+"']").firstElementChild.classList.add("tools-menu__size--active")}},{key:"changeColor",value:function(){var e=(0,i.hexToRGBA)(this.colorPicker.value),t="RGBA("+e.r+","+e.g+","+e.b+","+e.a+")";this.canvasController.selectedColorRGBA=e,this.canvasController.selectedColor=t,this.canvasController.changeColor(),document.documentElement.style.setProperty("--selected-color",t)}}],[{key:"closeOpenedSizeMenu",value:function(){var e=document.getElementById("size-menu");null!==e&&e.remove()}},{key:"removeActiveClass",value:function(){document.querySelectorAll(".tools-menu__icon").forEach(function(e){e.classList.remove("tools-menu__icon--active")})}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,i){t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]);var s={r:n[0],g:n[1],b:n[2],a:n[3]};if(s.r==r.r&&s.g==r.g&&s.b==r.b&&s.a==r.a)return;var o=e.getImageData(0,0,i.width,i.height),a=o.data,c=void 0,l=[];function u(e,t){var n={r:a[e],g:a[e+1],b:a[e+2],a:a[e+3]};if(n.r==r.r&&n.g==r.g&&n.b==r.b&&n.a==r.a)return!1;var i=Math.sqrt(r.r*r.r*.299+r.g*r.g*.587+r.b*r.b*.114);return c=i>200?20:i>85?175:250,Math.abs(n.r-t.r)<=c&&Math.abs(n.g-t.g)<=c&&Math.abs(n.b-t.b)<=c&&Math.abs(n.a-t.a)<=c}function h(e){a[e]=r.r,a[e+1]=r.g,a[e+2]=r.b,a[e+3]=r.a}l.push([t[0],t[1]]);for(;l.length&&!(l.length>100);){var d=void 0,v=void 0,f=void 0,p=void 0,y=void 0,g=void 0;for(d=l.pop(),v=d[0],f=d[1],p=4*(f*i.width+v);f>=0&&u(p,s);)p-=4*i.width,f--;for(p+=4*i.width,f++,y=!1,g=!1;f<i.height&&u(p,s);)h(p),v>0&&(u(p-4,s)?y||(l.push([v-1,f]),y=!0):y&&(y=!1)),v<i.width-1&&(u(p+4,s)?g||(l.push([v+1,f]),g=!0):g&&(g=!1)),p+=4*i.width,f++}e.putImageData(o,0,0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.socket=t,this.pathArray=[]}return r(e,[{key:"stopDrawing",value:function(t,n){t.preventDefault(),n.drawing=!1,this.pathArray.length>0&&(this.socket.sendDraw(this.pathArray,e.getBrushOrEraser(n),n.selectedColor),this.pathArray=[])}},{key:"clickStartHandler",value:function(e,t){e.preventDefault(),e.buttons>1||(t.setPositions(e.clientX,e.clientY),this.handleClickTouch(t))}},{key:"touchStartHandler",value:function(e,t){e.preventDefault();var n=e.changedTouches;if(!(n.length>1)){var r=n[0];t.setPositions(r.clientX,r.clientY),this.handleClickTouch(t)}}},{key:"handleClickTouch",value:function(t){var n=t;if("bucket"===t.selectedTool){var r=[t.currentX,t.currentY],i=t.selectedColorRGBA;return t.draw(!0),void this.socket.sendFloodFill(r,i)}"picker"!==t.selectedTool?(t.draw(!0),n.drawing=!0,this.pathArray.push({x:t.currentX,y:t.currentY}),this.socket.sendDraw(this.pathArray,e.getBrushOrEraser(t),t.selectedColor)):t.getColor()}},{key:"mouseMoveHandler",value:function(t,n){t.preventDefault(),"picker"!==n.selectedTool&&"bucket"!==n.selectedTool&&n.drawing&&(n.setPositions(t.clientX,t.clientY),n.draw(!1),this.pathArray.push({x:n.currentX,y:n.currentY}),50===this.pathArray.length&&(this.socket.sendDraw(this.pathArray,e.getBrushOrEraser(n),n.selectedColor),this.pathArray=this.pathArray.slice(49)))}},{key:"toucheMoveHandler",value:function(t,n){if(t.preventDefault(),"picker"!==n.selectedTool&&"bucket"!==n.selectedTool){var r=t.changedTouches;if(!(r.length>1)){var i=r[0];n.drawing&&(n.setPositions(i.clientX,i.clientY),n.draw(!1),this.pathArray.push({x:n.currentX,y:n.currentY}),50===this.pathArray.length&&(this.socket.sendDraw(this.pathArray,e.getBrushOrEraser(n),n.selectedColor),this.pathArray=this.pathArray.slice(49)))}}}}],[{key:"getBrushOrEraser",value:function(e){return"brush"===e.selectedTool?e.brush:e.eraser}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.minBrushSize=5,this.maxBrushSize=25,this.selectedSize=5,this.style="round",this.isBrush=t}return r(e,[{key:"changeSize",value:function(e){e<this.minBrushSize||e>this.maxBrushSize||(this.selectedSize=e)}},{key:"changeColor",value:function(e){this.color=e}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(6)),s=l(n(5)),o=l(n(4)),a=l(n(3)),c=n(0);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.brush=new i.default(!0),this.eraser=new i.default(!1),this.canvas=document.getElementById("canvas"),this.context=this.canvas.getContext("2d"),this.canvasContainer=this.canvas.parentElement,this.selectedTool="brush",this.selectedColor="black",this.selectedColorRGBA={r:0,g:0,b:0,a:255},this.drawing=!1,this.resizeCanvas(),this.setEvents(),this.currentX=null,this.currentY=null,this.previousX=null,this.previousY=null,this.events=new s.default(t),this.iconEvents=new a.default(this),this.iconEvents.setEvents()}return r(e,[{key:"setCanvasStyle",value:function(e,t){this.canvas.style.width=e+"px",this.canvas.style.height=t+"px"}},{key:"resizeCanvas",value:function(){this.width=this.canvasContainer.clientWidth,this.height=this.width/16*9,this.setCanvasStyle(this.width,this.height),this.canvasContainer.style.height=this.height+"px"}},{key:"selectBrush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.brush;this.context.globalCompositeOperation="source-over",this.context.strokeStyle=e.selectedColor||this.selectedColor,this.context.lineWidth=e.selectedSize,this.context.lineCap=e.style,this.context.lineJoin=e.style}},{key:"selectEraser",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.eraser;this.context.globalCompositeOperation="destination-out",this.context.lineWidth=e.selectedSize,this.context.lineCap=e.style,this.context.lineJoin=e.style}},{key:"changeBrushValues",value:function(e){this.brush=Object.assign(this.brush,e),this.selectBrush()}},{key:"changeEraserValues",value:function(e){this.eraser=Object.assign(this.eraser,e),this.selectEraser()}},{key:"changeColor",value:function(){this.context.strokeStyle=this.selectedColor}},{key:"selectBucket",value:function(){this.context.globalCompositeOperation="source-over"}},{key:"setPositions",value:function(e,t){this.previousX=this.currentX,this.previousY=this.currentY;var n=this.canvas.getBoundingClientRect(),r=this.canvas.width/n.width,i=this.canvas.height/n.height;this.currentX=(e-n.left)*r,this.currentY=(t-n.top)*i}},{key:"draw",value:function(e){if("bucket"!==this.selectedTool)"picker"!==this.selectedTool?("brush"===this.selectedTool?this.selectBrush():this.selectEraser(),this.context.beginPath(),e||this.context.moveTo(this.previousX,this.previousY),this.context.lineTo(this.currentX,this.currentY),this.context.stroke()):this.getColor();else{var t=[this.currentX,this.currentY],n=this.context.getImageData(this.currentX,this.currentY,1,1).data;(0,o.default)(this.context,t,n,this.selectedColorRGBA,this.canvas)}}},{key:"drawFromSocket",value:function(e){if(this.context.beginPath(),this.context.moveTo(e.path[0].x,e.path[0].y),1===e.path.length)return e.brush.isBrush?this.selectBrush(e.brush):this.selectEraser(e.brush),this.context.lineTo(e.path[0].x,e.path[0].y),void this.context.stroke();for(var t=1;t<e.path.length;t+=1)e.brush.isBrush?this.selectBrush(e.brush):this.selectEraser(e.brush),this.context.lineTo(e.path[t].x,e.path[t].y);this.context.stroke()}},{key:"floodFillFromSocket",value:function(e){var t=e.position,n=this.context.getImageData(t[0],t[1],1,1).data;(0,o.default)(this.context,t,n,e.selectedColor,this.canvas)}},{key:"getColor",value:function(){var e=this.context.getImageData(this.currentX,this.currentY,1,1).data,t={r:e[0],g:e[1],b:e[2],a:e[3]};this.selectedColorRGBA=t,this.selectedColor="RGBA("+t.r+", "+t.g+", "+t.b+", "+t.a+")";var n=this.selectedColorRGBA,r=n.r,i=n.g,s=n.b;this.iconEvents.colorPicker.value=(0,c.rgbToHex)(r,i,s),this.iconEvents.colorPicker.dispatchEvent(new Event("change",{bubbles:!0})),this.iconEvents.brushIcon.click()}},{key:"setEvents",value:function(){var e=this;this.canvas.addEventListener("mousedown",function(t){e.events.clickStartHandler(t,e)}),this.canvas.addEventListener("touchstart",function(t){e.events.touchStartHandler(t,e)}),this.canvas.addEventListener("mouseup",function(t){e.events.stopDrawing(t,e)}),this.canvas.addEventListener("mouseout",function(t){e.events.stopDrawing(t,e)}),this.canvas.addEventListener("touchend",function(t){e.events.stopDrawing(t,e)}),this.canvas.addEventListener("touchcancel",function(t){e.events.stopDrawing(t,e)}),this.canvas.addEventListener("mousemove",function(t){e.events.mouseMoveHandler(t,e)}),this.canvas.addEventListener("touchmove",function(t){e.events.toucheMoveHandler(t,e)})}}]),e}();t.default=u},function(e,t,n){"use strict";var r=o(n(7)),i=o(n(2)),s=o(n(1));function o(e){return e&&e.__esModule?e:{default:e}}var a=new i.default,c=new r.default(a),l=new s.default(c);c.selectBrush(),l.setEvents(),a.init(c)}]);